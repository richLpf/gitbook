## 1、前端工程化是什么

”前端工程化“是由于前端的发展，导致简单的HTML页面开发已经跟不上迭代的速度。

为了降低开发成本，增加开发效率，前端工程化的概念从软件工程演变而来。

> 软件工程是一门研究用工程化方法构建和维护有效、实用和高质量的软件的学科。
>
> 三个阶段：定义阶段：可行性研究初步项目计划、需求分析；开发阶段：概要设计、详细设计、实现、测试；运行和维护阶段：运行、维护、废弃
>
> 软件工程的目标是：在给定成本、进度的前提下，开发出具有适用性、有效性、可修改性、可靠性、可理解性、可维护性、可重用性、可移植性、可追踪性、可互操作性和满足用户需求的软件产品。

所以前端工程化其实没有一个统一的定义，在前端开发的基础上，一系列解决方案，都算前端工程的一部分。

目前前端工程化的一些模块，实现比较成熟了（前端规范、技术框架、单元测试、项目构建、项目部署、监控方案），可以在很大程度上帮助我们提高开发效率。

当然前端工程化有利也有弊，各种各样的解决方案和工具版本的更新，也导致了前端复杂的配置。



## 2、前端的演进

### 1、浅析前端发展过程

前端的发展是很迅猛的，我们重点关注下前端发展的过程

- 从最初的HTML到现在的三大框架和各种工具
- 从IE浏览器到谷歌浏览器
- 从HTML嵌套在后端语言到前后端分离，前端独立部署

- 从PC页面到现在的单页面应用、小程序、APP、桌面应用、微前端等
- 从最初的HTML+CSS+JS到现在的预编译语言、TS等

每个阶段的发展都会解决前期存在的问题，同时也带来了一系列的改变。

但不论怎么发展，前端底层的HTML、CSS、JS总是核心，更多的是语法的迭代和浏览器的的支持。

所以不管前端的项目架构、语言如何变化，最后浏览器执行的代码总是相同的。

> 就像盖房子，不管如何设计、如何装修、用什么材料，最终都是一块块砖头、水泥、涂料堆砌而成的。

在这个基础上，我们认识前端的发展，就会发现：因为Node的出现，我们不需要每次让代码通过浏览器执行，直接运行在Node环境下就可以了，而Node提供了更强大的能力，比如文件的读取、路径读取、http服务等等。利用这些能力，我们就可以发挥想象力，利用Node的能力项目进行读取和编译，最后转化成浏览器可执行的代码即可。

### 2、前端发展阶段遇到的问题

[软件开发就像小车过沟](https://v.qq.com/x/page/v3310lxbsoa.html)

前端要发展，就会遇到问题，遇到问题就要解决问题，解决问题就会带来新的问题，看起来是无解的问题，但却是客观存在的。

我们将前端开发分为几个阶段：需求分析阶段、开发阶段、部署阶段、维护阶段、优化阶段，在每个阶段都有很多值得思考的问题

#### 1、需求分析阶段

需求分析阶段要结合产品的网站类型、受众、市场、技术的成熟度等，根据现有资源选择不同的开发方案

- 你开发的是PC端还是移动端？
- 你开发的是面向内部用户使用还是外部客户的内容型网站？
- 使用TS还是JS？
- 你要选择的技术框架是什么，React还是Vue？

根据公司现有的资源，选择的方案肯定是不一样的。实际工作中往往大部分都不用考虑，因为要做什么一般老板说了算，使用的技术栈公司大部分公司也是统一的，至于选用的技术框架和JS库，一般都是市面上最成熟的。

目前根据需求，类似的应用场景：三大框架、小程序、移动端的UI框架、React Native、多端开发Flutter。这些都是比较成熟的技术方案。

#### 2、开发阶段

这个阶段就正式的开发了，我们来看这个阶段遇到的一些问题：

- 浏览器的兼容性
- 语言的缺陷：HTML的重复书写、CSS混乱、 JS灵活性和缺陷
- 页面切换的白屏问题和加载性能
- 前端的数据管理
- 前端代码的重复书写和复用

- 前后端分离带来的接口规范问题和前期后端API交付不及时问题
- 类库管理、打包问题
- 代码规范：变量命名、项目结构、样式统一、组件封装、代码格式

- 重复构建项目问题

读完上面的问题，也许有一些你已经想到我们常用的实现，比如浏览器兼容性使用Babel解析ES6+到ES5，使用postcss来兼容不同浏览器对CSS的识别。

以上只是列出了一部分开发阶段的问题，这些目前都有对应的解决方案，不管是通过插件、类库还是规范。

#### 3、部署阶段

这个阶段，就是要将开发好的代码实际运行起来，我们一般会通过构建工具，梳理代码依赖关系，压缩代码，将打包后的代码部署上线。

如何将庞大的源代码打包成可执行的代码，目前常见的构建工具Gulp、Rollupjs、Webpack、Vite等，都可以完成该阶段的工作，区别在于他们的实现思路不一样。

打包完成后，我们要将代码同步到服务器或者CDN源，如何每次手动处理，就容易出错了。

持续集成、持续部署（CI/CD）就出现了，通过Gitlab等代码管理平台提供的CICD能力，只需要简单的配置就可以保证项目的自动化部署。

当然在部署的过程中还会遇到版本问题，缓存更新问题、依赖版本和构建环境不同等问题。

#### 4、维护阶段

项目上线后需要维护，有一些隐藏的Bug（JS属性不存在、方法不兼容、接口报错、内存溢出、页面白屏等）。

在实际运行中，我们不可能看到用户使用中出现的问题，如果等待用户报障，就会很被动，且容易丢失客户，所以我们需要来监控代码的执行情况。这种情况下就出现了很多前端监控平台，用来收集前端用户的报错。

另一种情况就是，产品或老板需要看到前端站点的用户访问数据，我们常说的PV、UV等，这种情况下，就出现了很多数据监控平台，比如百度统计等。

#### 5、优化阶段

产品是不断迭代的，在页面上线后，对于重要页面，常常有很多针对性的优化：包括性能优化、代码重构、拆分函数等。

比如针对项目构建速度慢，可以增加构建工具的优化。

比如我们项目启动比较多，每次都重复构建显然不合理，开发脚手架统一管理。

比如代码重构，我们设计一些重构的原则，这样就有了优化的方向。



## 3、前端工程化如何实践

在实际的工作中，前端工程化一般通过各种规范、集成工具或插件来实现，随着项目的体量增大和开发人员越来越多，需要考虑前端工程化的内容越多。

我们主要从下面几个方面来阐述工程化思想，然后在各个模块的实现中，选择一种来具体实践。

### 1、技术选型

这个模块大公司一般是由技术经理或者架构师考虑的问题，小公司一般由个人或技术经理考虑。

随着技术的发展，各大框架层出不穷，但大部分公司都集中在三大框架React、Vue、Angular，而且学好一个就不容易了，所以公司内部一般都会使用一个确定的技术栈。

但是技术选型还是很重要的部分，毕竟前端现在是大前端，js能运行的地方就是前端的天下。而根据运行的环境不同，我们会选择不同的技术方案。

有些使用固定的开发技术，有的可选的就比较多，各有各的优缺点。

技术选型从哪些方面考虑？网站类型、运行环境、兼容性要求

### 2、前端规范

无规矩不成方圆，前端规范是前端开发过程中很重要的一个环节。

如果没有规范，项目将越来越乱，最后开发和查找问题将及其困难，所以越是大项目、涉及到的开发越多，前端的规范会越多。

这个也很好理解，为了保证代码的质量、效率、可读性，也必须制定各种规范。

而现在也有各种插件和工具来帮助前端项目实现这些规范，我们需要做的就是配置好这些工具，就可以保证项目的可持续开发。下面我们会初始化一个项目，在一下几个方面了解下前端的那些必要的规范，以及实现这些规范相关工具的使用。

我们将通过各种配置各种自动化插件，来帮助做代码规范。

- 基于CRA通过各种插件的使用来保证项目规范，如何定制项目的规范，后面增加如何通过CI来检测项目
- Git分支管理规范、提交说明规范、版本规范、Git的钩子检测规范

- UI规范- 通过UI库统一系统风格、CSS项目初始化、通过预编译语言，生成快速使用的CSS
- 前后端分离项目接口规范
- 从0搭建一个UI组件库

### 3、单元测试

前端我们需要测试的模块包括，函数、类、组件，我们将会通过引入测试框架来演示，如何对前端进行单元测试。

- 单元测试 - 函数测试、类测试、组件测试
- 测试框架的使用

### 4、构建

前后端分离以后，前端可以单独的部署开始，前端作为独立的资源模块。

如何减少前端资源的大小？

如何统一前端页面在不同浏览器的展现方式？

怎么加快访问速度，怎么方便的部署？

一个项目如何重复利用？

随着一个个问题的产生，解决方案也是五花八门，最后一些强大的构建工具留了下来。我们熟知的包括：Gulp、Webpack、Vite等。

这一章节，我们将讨论这些问题是如何解决的，并通过webpack构建一个项目，来帮助理解前端工程化关于构建模块的内容。

比如，CLI的出现，让前端可以统一管理起不同的模版，通过命令行实现各种。

- 如何构建一个企业级CLI工具

### 5、部署

构建完毕后，就要进行部署，启动一个服务器就可以转发这些前端资源。而最初的我们通过后端服务转发前端资源，变成前端作为单独的服务部署，我们可以通过Nginx配置转发来解决，但也会出现很多问题

- 每次部署都要将构建的项目，放在特定的服务器目录下，手动处理就很容易出错了，而且在替换原有的代码时也容易出现网站短暂的异常。
- 服务器、Nginx升级或服务器宕机，导致前端服务无法访问，那么如何快速重新部署一套。
- 对于出售的私有化前端项目，如何保证客户运行的环境和我们的开发环境一致。
- 项目Bug不可避免，那么在出现Bug后，我们如何快速会退？
- 项目版本更新后，如何保证用户可以访问最新的代码？
- 一些前端资源，例如国家行政区域数据，是很多年不会变的，那么如何缓存这些资源？
- 部署前端项目，如何进行灰度？

这些问题都是在前端部署过程中实际遇到的问题，那么如何解决呢？我们先从简单的问题入手，解决问题的角度，来实践不同的部署方案。

比如说，持续集成、持续部署，通过Gitlab的CICD，减少了手动检查代码、手动构建、姿态资源上传等各种零散的工作，减少了出错的机会。

- 项目部署篇 - 如何使用Nginx和Shell脚本打通前端部署流程

- 项目部署篇 - 如何使用Docker部署统一的版本环境
- 项目部署篇 - 如何使用Gitlab CICD完成自动化部署

完成了上面的章节，我们在这一节通过CICD，将前面用到的串联起来，完成整个项目的持续集成持续部署。

### 6、监控

- 同一份代码，在浏览器中的兼容性是不同的，我们不可能测试所有的浏览器和所有的版本，也不可能统一用户使用的浏览器类型和版本，那么用户在访问过程中遇到了问题，我们该如何查看具体原因？
- 对于网站来说，如果用户的体验很差，那么就会导致用户流失，那么除了本地用户可以对页面加载性能进行分析、发起问卷调查，如何通过技术手段实现获取用户网站加载的时间和留存率呢？
- 对于营销网站、数据网站来说，要投放广告，那么我们如何知道用户主要来自哪个省份？

以上问题，是前端监控方面我们需要思考的，而现在关于监控也有各种各样的解决方案，我们带着问题下面将会展开讨论如何对项目惊醒监控。

- 前端监控 - 如何实时监控访问用户出现的js报错

- 性能监控 - 如何提高代码执行的性能
- 数据监控 - 如何获取用户访问的信息

### 7、安全

我们常说：前端重体验、后端重安全。但前端也要了解重要的安全问题，如果不注意也可能存在被攻击。

### 8、性能优化

- 性能优化 - 前端性能检查

- 性能优化 - 如何提高webpack构建项目的速度
- 如何做一个性能监控的平台