## 一、什么是CSRF攻击

我们常常听到这样一句话：默认的链接不要点，那些年也听过，邮箱中的垃圾链接不要点。
因为可能是黑客发起的CSRF攻击，所以再点击之前最好是确认链接的安全性。

## 二、CSRF攻击的案例

### 1、陌生邮件攻击

### 2、陌生链接攻击

## 四、CSRF攻击的实践



## 三、CSRF攻击的原理

### 1、攻击的流程

用户登录某个站点后，黑客引诱用户访问第三方的恶意站点，恶意站点利用用户的登录凭证，向用户站点发送伪造的请求，从而执行某种损害用户利益的操作。

具体的流程是：
- 1、用户访问a.com（正常站点），并保持登录状态
- 2、黑客引诱用户登录hack.com(第三方恶意站点)，hack.com携带登录凭证向a.com发送请求
- 3、a.com验证非法请求的登录凭证，误以为是用户执行了某种操作。
- 4、攻击成功，a.com执行操作（转账、开通权限、邮件过滤等）

### 2、攻击的特点

1、CSRF攻击一般是第三方站点发起，即肯定是跨域攻击
2、CSRF攻击无法获取站点的Cookie，只能冒用

## 五、如何阻止CSRF攻击

### 1、不点击陌生或者不被信任的网址

这一条就很厉害了，保证安全，不明邮件或者不明URL不要点击。

### 2、阻止第三方服务器向站点发送请求

#### 1）csp

#### 2）samesite origin(兼容性不好)

#### 3）Token

token的校验很常见，不仅可以用来做登录验证，也可以在使用Cookies做登录认证的同时使用token做CSRF的鉴权

token都是由后端服务拼接随机字符串和时间戳，用户id等内容后通过加密算法得到的。

通过Token鉴权的几种方式

1、token记录在数据库中

2、保存的前端浏览器中

### 3、服务端校验请求来源

#### 1、同源检测
同源策略可以防止csrf攻击吗？还需要验证请求头吗？
验证请求来源origin和referer
